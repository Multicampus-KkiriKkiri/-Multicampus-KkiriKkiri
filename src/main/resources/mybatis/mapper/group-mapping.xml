<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="group-mapping">

    <!-- 그룹 상세 정보 가져오기 -->
    <select id="getGroupDetail" resultType="groupdto">
        select * from `group` where groupId = #{groupId}
    </select>
    
    <!-- 지역 정보 가져오기(시,도) 가져오기 -->
    <select id="getAllRegions" resultType="dto.RegionDTO">
        SELECT regionId, regionName
        FROM regions
    </select>
    
    <!-- 지역(Region) 이름 가져오기 -->
    <select id="getRegionNameByRegionId" resultType="String">
    	select `regionName` from `regions` where regionId = #{regionId}
    </select>

    <!-- 하위 지역 정보 가져오기 -->
    <select id="getDistrictsByRegionId" parameterType="int" resultType="dto.DistrictDTO">
        SELECT districtId, regionId, districtName
        FROM districts
        WHERE regionId = #{regionId}
    </select>
    
    <!-- 하위 지역(District) 이름 가져오기 -->
    <select id="getDistrictNameByDistrictId" resultType="String">
    	select `districtName` from `districts` where districtId = #{districtId}
    </select>
    
    <!-- 새로운 그룹 등록 -->
    <insert id="saveGroup" parameterType="dto.GroupDTO" useGeneratedKeys="true" keyProperty="groupId">
        INSERT INTO `group` (groupName, groupInterestId, groupRegionId, groupDistrictId, groupDetail, groupImage, groupMaximum, groupType, groupSignUpType, groupSignUpQuestion)
        VALUES (#{groupName}, #{groupInterestId}, #{groupRegionId}, #{groupDistrictId}, #{groupDetail}, #{groupImage}, #{groupMaximum}, #{groupType}, #{groupSignUpType}, #{groupSignUpQuestion})
    </insert>
    
    <select id="findGroupById" parameterType="int" resultType="dto.GroupDTO">
        SELECT <include refid="groupColumns"/>
        FROM `group`
        WHERE groupId = #{groupId}
    </select>
  
    <sql id="groupColumns">
        groupId, groupName, category, region, district, description, groupImage, maxParticipants, question
    </sql>
        
</mapper>
